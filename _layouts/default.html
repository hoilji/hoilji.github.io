<!DOCTYPE html>
<html lang="{{ site.lang }}">

  <!-- Head -->
  <head>
  {%- if page.redirect -%}
    <meta http-equiv="refresh" content="3; url={{ site.baseurl }}/" />
  {%- endif -%}
  {% include head.html %}
  </head>

  <!-- Body -->
  <body class="{% if site.navbar_fixed %}fixed-top-nav{% endif %} {% unless site.footer_fixed %}sticky-bottom-footer{% endunless %}">

    <!-- Header -->
    {%- include header.html %}

    <!-- Content -->
    <div class="container mt-5">
      {{ content }}
    </div>

    <!-- Footer -->
    {%- include footer.html %}

    
    <!-- JavaScripts -->
    {% include scripts/jquery.html %}
    {% include scripts/bootstrap.html %}
    {% include scripts/masonry.html %}
    {% include scripts/misc.html %}
    {% include scripts/badges.html %}
    {% include scripts/mathjax.html %}
    {% include scripts/analytics.html %}
    {% include scripts/progressBar.html %}

    {% include scripts/progressBar.html %}


  
<script>
  function currentThemeIsDark() {
    // 1) al-folio가 저장하는 값(가장 우선)
    const saved = localStorage.getItem("theme"); // "dark" | "light" | "system" | null
    if (saved === "dark") return true;
    if (saved === "light") return false;

    // 2) 혹시 data-theme / data-mode 같은 attribute 쓰는 경우까지 대응
    const dt = document.documentElement.getAttribute("data-theme")
           || document.body.getAttribute("data-theme")
           || document.documentElement.getAttribute("data-mode")
           || document.body.getAttribute("data-mode");
    if (dt === "dark") return true;
    if (dt === "light") return false;

    // 3) system(또는 저장값이 없을 때): OS 설정 따라가기
    return window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
  }

  function setLogoByTheme() {
    const isDark = currentThemeIsDark();
    document.querySelectorAll("img.site-logo").forEach(img => {
      const light = img.getAttribute("data-logo-light");
      const dark  = img.getAttribute("data-logo-dark");
      img.src = isDark ? dark : light;
    });
  }

  // 최초 1회
  document.addEventListener("DOMContentLoaded", setLogoByTheme);

  // 토글 버튼 클릭 시: al-folio 스크립트가 localStorage를 업데이트한 다음 반영되도록 약간 딜레이
  const toggleBtn = document.getElementById("light-toggle");
  if (toggleBtn) {
    toggleBtn.addEventListener("click", () => setTimeout(setLogoByTheme, 50));
  }

  // system 테마일 때 OS 테마 변경도 추적
  const mq = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)");
  if (mq && mq.addEventListener) mq.addEventListener("change", setLogoByTheme);

  // 다른 코드가 attribute를 바꾸는 경우도 추적
  const obs = new MutationObserver(setLogoByTheme);
  obs.observe(document.documentElement, { attributes: true });
  obs.observe(document.body, { attributes: true });

  // 혹시 테마 스크립트가 늦게 로드/적용되는 경우 대비: 짧게 1번 더
  window.addEventListener("load", () => setTimeout(setLogoByTheme, 50));
</script>

          <!-- Visitor counter script -->
<script src="https://cdn.jsdelivr.net/npm/counterapi/dist/counter.browser.min.js"></script>
<script src="{{ '/assets/js/visit-counter.js' | relative_url }}"></script>
    
  </body>
</html>  
  
